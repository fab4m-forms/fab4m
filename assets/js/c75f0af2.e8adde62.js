"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[3917],{29090:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>F,contentTitle:()=>y,default:()=>C,frontMatter:()=>w,metadata:()=>a,toc:()=>S});const a=JSON.parse('{"id":"guide/events","title":"Form events","description":"Each form created by fab4m provides several events that can be used","source":"@site/docs/guide/events.mdx","sourceDirName":"guide","slug":"/guide/events","permalink":"/docs/guide/events","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"Theming","permalink":"/docs/guide/theming"},"next":{"title":"Component Widgets","permalink":"/docs/guide/widgets"}}');var r=t(74848),o=t(28453),i=t(53603),s=t(1173),l=t(96540);const d=(0,s.DG)({name:(0,s.M8)({label:"Name"}),bio:(0,s.M8)({label:"Bio",widget:(0,s.N3)()}),age:(0,s.nm)({label:"Age"})});function u(){const[e,n]=(0,l.useState)({name:"Fabian S\xf6rqvist",bio:"This is my bio",age:33});return d.onDataChange((e=>{n(e)})),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.co,{form:d,data:e,hideSubmit:!0}),(0,r.jsx)("div",{children:(0,r.jsxs)("dl",{children:[(0,r.jsx)("dt",{children:"Name"}),(0,r.jsx)("dd",{children:e.name}),(0,r.jsx)("dt",{children:"Bio"}),(0,r.jsx)("dd",{children:e.bio}),(0,r.jsx)("dt",{children:"Age"}),(0,r.jsx)("dd",{children:e.age})]})})]})}const c='import {\n  createForm,\n  textField,\n  integerField,\n  FormView,\n  textAreaWidget,\n} from "@fab4m/fab4m";\nimport React, { useState } from "react";\n\nconst form = createForm({\n  name: textField({ label: "Name" }),\n  bio: textField({ label: "Bio", widget: textAreaWidget() }),\n  age: integerField({ label: "Age" }),\n});\n\nexport function OnChangeExample() {\n  // We set up a state within this component with some defaults.\n  const [data, changeData] = useState({\n    name: "Fabian S\xf6rqvist",\n    bio: "This is my bio",\n    age: 33,\n  });\n  // When our data changes, we update our state, so that we have the\n  // current fresh form data available.\n  form.onDataChange((newData) => {\n    // This could be written just as form.onDataChange(changeData)\n    changeData(newData);\n  });\n  // We render our form using the FormView component, and render the\n  // information that is changed by the form on the fly.\n  return (\n    <>\n      <FormView form={form} data={data} hideSubmit={true} />\n      <div>\n        <dl>\n          <dt>Name</dt>\n          <dd>{data.name}</dd>\n          <dt>Bio</dt>\n          <dd>{data.bio}</dd>\n          <dt>Age</dt>\n          <dd>{data.age}</dd>\n        </dl>\n      </div>\n    </>\n  );\n}\n',m=(0,s.DG)({age:(0,s.nm)({label:"Age"})});function h(){const[e,n]=(0,l.useState)(void 0);return m.onComponentChange(((e,t)=>{"age"===e&&n(t)})),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.WJ,{form:m,hideSubmit:!0}),e&&(0,r.jsxs)("p",{style:{fontWeight:"bold"},children:["You are ",e," years old"]})]})}const f='import { createForm, integerField, StatefulFormView } from "@fab4m/fab4m";\nimport React, { useState } from "react";\n\nconst ageForm = createForm({\n  age: integerField({ label: "Age" }),\n});\n\nexport function OnComponentChangeExample() {\n  // We store the age in this state.\n  const [age, changeAge] = useState(undefined);\n  // When the age component is updated, we update our state.\n  ageForm.onComponentChange((name, value) => {\n    if (name === "age") {\n      changeAge(value);\n    }\n  });\n  // Render our form, and print out our current age when it\'s available.\n  return (\n    <>\n      <StatefulFormView form={ageForm} hideSubmit={true} />\n      {age && <p style={{ fontWeight: "bold" }}>You are {age} years old</p>}\n    </>\n  );\n}\n',p=(0,s.DG)({name:(0,s.M8)({label:"Name"}),bio:(0,s.M8)({label:"Bio",widget:(0,s.N3)()}),age:(0,s.nm)({label:"Age"})});function g(){const[e,n]=(0,l.useState)(void 0);return p.onSubmit(((e,t)=>{e.preventDefault(),n(t)})),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.WJ,{form:p}),e&&(0,r.jsxs)("p",{style:{fontWeight:"bold"},children:["Welcome ",e.name]})]})}const b='import {\n  createForm,\n  textField,\n  integerField,\n  textAreaWidget,\n  StatefulFormView,\n} from "@fab4m/fab4m";\nimport React, { useState } from "react";\n\nconst form = createForm({\n  name: textField({ label: "Name" }),\n  bio: textField({ label: "Bio", widget: textAreaWidget() }),\n  age: integerField({ label: "Age" }),\n});\n\nexport function OnSubmitExample() {\n  // This state will be updated with the data when we submit the form.\n  const [submitted, changeSubmittedData] = useState(undefined);\n  form.onSubmit((e, data) => {\n    // The event is a React FormEvent.\n    e.preventDefault();\n    // We update the state with our data.\n    changeSubmittedData(data);\n  });\n  return (\n    <>\n      <StatefulFormView form={form} />\n      {submitted && (\n        <p style={{ fontWeight: "bold" }}>Welcome {submitted.name}</p>\n      )}\n    </>\n  );\n}\n',v=(0,s.DG)({name:(0,s.M8)({label:"Name"}),age:(0,s.nm)({label:"Age"}),confirmAge:(0,s.hQ)({required:!0,label:"I confirm I'm at least 18 years of age"}),break:(0,s.J2)({}),bio:(0,s.M8)({label:"Bio",widget:(0,s.N3)()})});function x(){const[e,n]=(0,l.useState)(!1);return v.onPartValidate((async(e,n)=>{if(0===e){const e=[];return n.age<18&&e.push({path:"/age",message:"You are under age"}),n.name.toLowerCase().includes("sam")&&e.push({path:"/name",message:"Sam is always under age"}),e}if(1===e&&n.name.toLowerCase().includes("fabian")&&n.bio.toLowerCase().includes("computer science"))return[{path:"/bio",message:"Consider a different profession"}]})).onSubmit((e=>{e.preventDefault(),n(!0)})),e?(0,r.jsx)("p",{children:"Welcome, you're the right person for the job!"}):(0,r.jsx)(s.WJ,{form:v})}const j='import React, { useState } from "react";\nimport {\n  createForm,\n  textField,\n  integerField,\n  booleanField,\n  textAreaWidget,\n  StatefulFormView,\n  pageBreak,\n} from "@fab4m/fab4m";\n\nconst partValidateForm = createForm({\n  name: textField({ label: "Name" }),\n  age: integerField({ label: "Age" }),\n  confirmAge: booleanField({\n    required: true,\n    label: "I confirm I\'m at least 18 years of age",\n  }),\n  break: pageBreak({}),\n  bio: textField({ label: "Bio", widget: textAreaWidget() }),\n});\nexport function OnPartValidateForm() {\n  const [completed, changeCompleted] = useState(false);\n  partValidateForm\n    .onPartValidate(async (part, data) => {\n      if (part === 0) {\n        const errors = [];\n        if (data.age < 18) {\n          errors.push({ path: "/age", message: "You are under age" });\n        }\n        if (data.name.toLowerCase().includes("sam")) {\n          errors.push({ path: "/name", message: "Sam is always under age" });\n        }\n        return errors;\n      }\n      if (\n        part === 1 &&\n        data.name.toLowerCase().includes("fabian") &&\n        data.bio.toLowerCase().includes("computer science")\n      ) {\n        return [{ path: "/bio", message: "Consider a different profession" }];\n      }\n    })\n    .onSubmit((e) => {\n      e.preventDefault();\n      changeCompleted(true);\n    });\n  return completed ? (\n    <p>Welcome, you\'re the right person for the job!</p>\n  ) : (\n    <StatefulFormView form={partValidateForm} />\n  );\n}\n',w={sidebar_position:4},y="Form events",F={},S=[{value:"Listen for all data changes",id:"listen-for-all-data-changes",level:2},{value:"Listen for changes in one specific component",id:"listen-for-changes-in-one-specific-component",level:2},{value:"Example",id:"example",level:3},{value:"Handling form submits",id:"handling-form-submits",level:2},{value:"Example",id:"example-1",level:3},{value:"Using events for custom validation",id:"using-events-for-custom-validation",level:2},{value:"Example",id:"example-2",level:3},{value:"Adding multiple form listeners to the same event",id:"adding-multiple-form-listeners-to-the-same-event",level:2}];function A(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"form-events",children:"Form events"})}),"\n",(0,r.jsx)(n.p,{children:"Each form created by fab4m provides several events that can be used\nto be notified about the form lifecycle. We provide events for when data changes,\nWhen data is submitted, and when data is being validated."}),"\n",(0,r.jsx)(n.h2,{id:"listen-for-all-data-changes",children:"Listen for all data changes"}),"\n",(0,r.jsxs)(n.p,{children:["Each time any component in the form changes the ",(0,r.jsx)(n.code,{children:"onDataChange"})," event is fired.\nAll of the form data is passed to the form as an object."]}),"\n",(0,r.jsx)(i.A,{source:c,example:(0,r.jsx)(u,{})}),"\n",(0,r.jsx)(n.h2,{id:"listen-for-changes-in-one-specific-component",children:"Listen for changes in one specific component"}),"\n",(0,r.jsxs)(n.p,{children:["You might not want to handle the whole state, and instead only\nlisten for changes in certain components. This can be done\nusing the ",(0,r.jsx)(n.code,{children:"onComponentChange"})," event."]}),"\n",(0,r.jsx)(n.h3,{id:"example",children:"Example"}),"\n",(0,r.jsx)(i.A,{source:f,example:(0,r.jsx)(h,{})}),"\n",(0,r.jsx)(n.h2,{id:"handling-form-submits",children:"Handling form submits"}),"\n",(0,r.jsxs)(n.p,{children:["Use the ",(0,r.jsx)(n.code,{children:"onSubmit"})," function to handle form submissions. This function is called\nwhenever the form is submitted and it's only called if the form data is valid,\nso you can rely on your data being complete at this point."]}),"\n",(0,r.jsx)(n.h3,{id:"example-1",children:"Example"}),"\n",(0,r.jsx)(i.A,{source:b,example:(0,r.jsx)(g,{})}),"\n",(0,r.jsx)(n.h2,{id:"using-events-for-custom-validation",children:"Using events for custom validation"}),"\n",(0,r.jsxs)(n.p,{children:["Sometimes you need to add custom validation for your form, for instance,\nif you need to verify that an email doesn't exist, or any other\nvalidation that requires data. You can use the ",(0,r.jsx)(n.code,{children:"onPartValidate"})," event for this.\nthe ",(0,r.jsx)(n.code,{children:"onPartValidate"})," function is called each timea form part is submitted."]}),"\n",(0,r.jsx)(n.p,{children:"the listener is asynchronous, so any required server validation\ncan occur within."}),"\n",(0,r.jsx)(n.p,{children:"Errors encountered should be returned as an array with the following structure:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-jsx",children:'[{\n    path: "/component" // <--- This is a JSON pointer,\n    message: "This is the message that will be shown in the form"\n}];\n'})}),"\n",(0,r.jsx)(n.p,{children:"See the validator documentation for more information about validating your data."}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsx)(n.p,{children:"You can also define custom component validators. This works well when you only need\nthe data from one specific component, but if you require the data from the full form\nyou're probably better off using this event instead.\nSee the documentation on how to create your own component validators."})}),"\n",(0,r.jsx)(n.h3,{id:"example-2",children:"Example"}),"\n",(0,r.jsx)(n.p,{children:"The example below performs validation on each of the form parts:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:'On part 1, we ensure that the provided age is over 18 and that the name doesn\'t contain "sam"'}),"\n",(0,r.jsx)(n.li,{children:'On part 2, We encourage the user to switch profession, if the name provided in part 1 contains "Fabian" and the text "Computer science" is part of the bio.'}),"\n"]}),"\n",(0,r.jsx)(i.A,{source:j,example:(0,r.jsx)(x,{})}),"\n",(0,r.jsx)(n.h2,{id:"adding-multiple-form-listeners-to-the-same-event",children:"Adding multiple form listeners to the same event"}),"\n",(0,r.jsx)(n.p,{children:"Fab4m forms support multiple event listeners for the same event. By default we override\nthe registered events when we add any event listener, because you normally add these events\ninside of a React component, and we want to provide the current event handler function to avoid weird scope errors."}),"\n",(0,r.jsx)(n.p,{children:"If you want to use multiple events you can do that by telling the form to append the event:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-jsx",children:"form.onChange(() => {\n  // Listener one.\n}, true).onChange(() => {\n  // Listener two.\n}, true)\n"})})]})}function C(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(A,{...e})}):A(e)}},79329:(e,n,t)=>{t.d(n,{A:()=>i});t(96540);var a=t(34164);const r={tabItem:"tabItem_Ymn6"};var o=t(74848);function i(e){let{children:n,hidden:t,className:i}=e;return(0,o.jsx)("div",{role:"tabpanel",className:(0,a.A)(r.tabItem,i),hidden:t,children:n})}},65537:(e,n,t)=>{t.d(n,{A:()=>y});var a=t(96540),r=t(34164),o=t(65627),i=t(56347),s=t(50372),l=t(30604),d=t(11861),u=t(78749);function c(e){return a.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,a.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function m(e){const{values:n,children:t}=e;return(0,a.useMemo)((()=>{const e=n??function(e){return c(e).map((e=>{let{props:{value:n,label:t,attributes:a,default:r}}=e;return{value:n,label:t,attributes:a,default:r}}))}(t);return function(e){const n=(0,d.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function h(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function f(e){let{queryString:n=!1,groupId:t}=e;const r=(0,i.W6)(),o=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:n,groupId:t});return[(0,l.aZ)(o),(0,a.useCallback)((e=>{if(!o)return;const n=new URLSearchParams(r.location.search);n.set(o,e),r.replace({...r.location,search:n.toString()})}),[o,r])]}function p(e){const{defaultValue:n,queryString:t=!1,groupId:r}=e,o=m(e),[i,l]=(0,a.useState)((()=>function(e){let{defaultValue:n,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!h({value:n,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const a=t.find((e=>e.default))??t[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:n,tabValues:o}))),[d,c]=f({queryString:t,groupId:r}),[p,g]=function(e){let{groupId:n}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(n),[r,o]=(0,u.Dv)(t);return[r,(0,a.useCallback)((e=>{t&&o.set(e)}),[t,o])]}({groupId:r}),b=(()=>{const e=d??p;return h({value:e,tabValues:o})?e:null})();(0,s.A)((()=>{b&&l(b)}),[b]);return{selectedValue:i,selectValue:(0,a.useCallback)((e=>{if(!h({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);l(e),c(e),g(e)}),[c,g,o]),tabValues:o}}var g=t(9136);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var v=t(74848);function x(e){let{className:n,block:t,selectedValue:a,selectValue:i,tabValues:s}=e;const l=[],{blockElementScrollPositionUntilNextRender:d}=(0,o.a_)(),u=e=>{const n=e.currentTarget,t=l.indexOf(n),r=s[t].value;r!==a&&(d(n),i(r))},c=e=>{let n=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{const t=l.indexOf(e.currentTarget)+1;n=l[t]??l[0];break}case"ArrowLeft":{const t=l.indexOf(e.currentTarget)-1;n=l[t]??l[l.length-1];break}}n?.focus()};return(0,v.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.A)("tabs",{"tabs--block":t},n),children:s.map((e=>{let{value:n,label:t,attributes:o}=e;return(0,v.jsx)("li",{role:"tab",tabIndex:a===n?0:-1,"aria-selected":a===n,ref:e=>{l.push(e)},onKeyDown:c,onClick:u,...o,className:(0,r.A)("tabs__item",b.tabItem,o?.className,{"tabs__item--active":a===n}),children:t??n},n)}))})}function j(e){let{lazy:n,children:t,selectedValue:o}=e;const i=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=i.find((e=>e.props.value===o));return e?(0,a.cloneElement)(e,{className:(0,r.A)("margin-top--md",e.props.className)}):null}return(0,v.jsx)("div",{className:"margin-top--md",children:i.map(((e,n)=>(0,a.cloneElement)(e,{key:n,hidden:e.props.value!==o})))})}function w(e){const n=p(e);return(0,v.jsxs)("div",{className:(0,r.A)("tabs-container",b.tabList),children:[(0,v.jsx)(x,{...n,...e}),(0,v.jsx)(j,{...n,...e})]})}function y(e){const n=(0,g.A)();return(0,v.jsx)(w,{...e,children:c(e.children)},String(n))}},53603:(e,n,t)=>{t.d(n,{A:()=>l});t(96540);var a=t(35363),r=t(55875),o=t(65537),i=t(79329),s=t(74848);function l(e){return(0,s.jsxs)(o.A,{children:[(0,s.jsx)(i.A,{value:"code",label:"Code",children:(0,s.jsx)(r.A,{language:"jsx",children:e.source})}),(0,s.jsx)(i.A,{value:"example",label:"Example",children:(0,s.jsx)(a.A,{children:()=>e.example})})]})}}}]);